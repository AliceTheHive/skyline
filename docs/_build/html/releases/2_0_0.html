

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2.0.0 &mdash; Skyline 2.0.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/skyline.styles.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Skyline 2.0.0 documentation" href="../index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Skyline
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running-in-python-virtualenv.html">Running Skyline in a Python virtualenv</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running-in-python-virtualenv-py2.html">Running Skyline in a Python 2.7 virtualenv</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrading/index.html">Upgrading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-data-into-skyline.html">Getting data into Skyline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alert-testing.html">Alert testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alerts.html">Alerts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker.html">docker - EXPERIMENTAL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../slack.html">slack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monotonic-metrics.html">Strictly increasing monotonicity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../horizon.html">Horizon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analyzer.html">Analyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analyzer-optimizations.html">Analyzer Optimizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algorithms/index.html">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mirage.html">Mirage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../boundary.html">Boundary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../crucible.html">Crucible</a></li>
<li class="toctree-l1"><a class="reference internal" href="../panorama.html">Panorama</a></li>
<li class="toctree-l1"><a class="reference internal" href="../webapp.html">Webapp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ionosphere.html">Ionosphere</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ionosphere_echo.html">Ionosphere echo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tsfresh.html">tsfresh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../luminosity.html">Luminosity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../flux.html">Flux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vista.html">Vista</a></li>
<li class="toctree-l1"><a class="reference internal" href="../redis-integration.html">Redis integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rebrow.html"><span class="red">re</span><span class="brow">brow</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../running-multiple-skylines.html">Running multiple Skyline instances</a></li>
<li class="toctree-l1"><a class="reference internal" href="../skyline-and-friends.html">Skyline and friends</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tuning-tips.html">Tuning tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tuning-tips.html#smaller-deployments">Smaller deployments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tuning-tips.html#reliability">Reliability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monitoring-skyline.html">Monitoring Skyline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debian-and-vagrant-installation-tips.html">Debian and Vagrant Installation Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whats-new.html">What&#8217;s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../skyline.html">skyline package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Skyline</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>2.0.0</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/releases/2_0_0.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>2.0.0<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>v2.0.0 - December 31, 2019</p>
<p>This is a major release with some additional features functionality and minor
bug fixes.  This release moves Skyline fully to Python 3 with backwards
compatibility with Python 2.7.</p>
<div class="section" id="important-notice">
<h2>IMPORTANT NOTICE<a class="headerlink" href="#important-notice" title="Permalink to this headline">¶</a></h2>
<p>In order to upgrade to Python 3.7.6 first update Skyline from v1.3.0 (or v1.3.1)
to v2.0.0 as documented below in the How to update section.  After you have
Skyline running on v2.0.0 with your current Python version, then refer to the
<a class="reference external" href="upgrading/py2-to-py3.html">Upgrading from py2 to py3</a> page.</p>
<p>Skyline requires a modification to the runner.py of the python-daemon 2.2.3
package.</p>
</div>
<div class="section" id="summary-of-changes-in-v2-0-0">
<h2>Summary of changes in v2.0.0<a class="headerlink" href="#summary-of-changes-in-v2-0-0" title="Permalink to this headline">¶</a></h2>
<p>Lots of changes have been introduced to accommodate Python 3.7 and 2.7, not all
changes are documented here related to the py3 changes just the main ones and
additional functionality.  For a full list of the changes see
<a class="reference external" href="https://github.com/earthgecko/skyline/compare/v1.3.0...v2.0.0">https://github.com/earthgecko/skyline/compare/v1.3.0...v2.0.0</a> (v1.3.1 was a very
minor change).</p>
<ul class="simple">
<li>py3 (3262)</li>
<li>Update least_squares &amp; grubbs algorithms by using sample standard deviation as
per PR #124 (3256), thanks to &#64;51wenyu</li>
<li>py3 Redis binary objects not strings (3266)</li>
<li>Always send anomaly_breakdown and exception metrics (3288)</li>
<li>Record the anomaly_end_timestamp (3306)</li>
<li>Gracefully handle db failure (3310)</li>
<li>Added multiple webapp api methods (3336, 3350)</li>
<li>Add CUSTOM_ALERT_OPTS to settings (3194) ported to Boundary</li>
<li>py3 - handle system parameter in Graphite cactiStyle (3294)</li>
<li>Handle urllib2 in py3 (3290)</li>
<li>flux.populateMetricQueue Full (3254)</li>
<li>flux - populate_metric_worker - handle None in datapoints (3312)</li>
<li>Allow Skyline to send metrics to another Carbon host (3250) in flux</li>
<li>py3 handle bytes and not str in pickles (3278)</li>
<li>horizon - listen - py3 handle msgpack bytes (3272)</li>
<li>Handle py2 xange and py3 range (3280)</li>
<li>py3 - handle pymemcache bytes not str (3304)</li>
<li>Handle csv.reader in py3 (3302)</li>
<li>Add label to features profile (2516) - Added missing echo label</li>
<li>Ionosphere spawn_learn_process hanging on docker (3296)</li>
<li>Vista - batch Graphite requests (3338)</li>
<li>Reduce vista logging (3258)</li>
<li>vista - fetcher add time_to_fetch metric (3260)</li>
<li>Deprecate string.replace for py3 (3270)</li>
<li>ionosphere_backend.py fallback to available ts_json (3286)</li>
<li>users DB table (3230)</li>
<li>Label and relate anomalies (2476)</li>
<li>Add label to features profile (2516)</li>
<li>fp creation json response (3348)</li>
<li>webapp - rebrow - jwt.encode generating bytes instead of a string in py3 (3268)</li>
<li>docker (3002) - functions added</li>
<li>Make Skyline docker handle OOMkiller (3318)</li>
</ul>
</div>
<div class="section" id="update-notes">
<h2>Update notes<a class="headerlink" href="#update-notes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>These update instruction apply to upgrading from v1.3.0 (or v1.3.1) to v2.0.0
only. However as with all Skyline updates it is possible to go through the update
notes for each version and make your own update notes/process to take you from
version x to version y.</li>
<li>There are changes to the DB in v2.0.0</li>
<li>There are changes to settings.py in v2.0.0, please ensure you diff your
current and the new settings.py as there are appended additions but there are
also additional settings that have been added to existing settings blocks.
The additions and changes described below.</li>
</ul>
<div class="section" id="settings-py-changes">
<h3>settings.py Changes<a class="headerlink" href="#settings-py-changes" title="Permalink to this headline">¶</a></h3>
<p>Modified settings:</p>
<ul class="simple">
<li><a class="reference internal" href="../skyline.html#settings.ALERTS" title="settings.ALERTS"><code class="xref py py-mod docutils literal"><span class="pre">settings.ALERTS</span></code></a> modified to include http_alerter type</li>
<li><a class="reference internal" href="../skyline.html#settings.CUSTOM_ALERT_OPTS" title="settings.CUSTOM_ALERT_OPTS"><code class="xref py py-mod docutils literal"><span class="pre">settings.CUSTOM_ALERT_OPTS</span></code></a> modified to include ionosphere_link_path</li>
<li><a class="reference internal" href="../skyline.html#settings.DO_NOT_SKIP_LIST" title="settings.DO_NOT_SKIP_LIST"><code class="xref py py-mod docutils literal"><span class="pre">settings.DO_NOT_SKIP_LIST</span></code></a> modified to include skyline.exceptions</li>
<li><a class="reference internal" href="../skyline.html#settings.BOUNDARY_METRICS" title="settings.BOUNDARY_METRICS"><code class="xref py py-mod docutils literal"><span class="pre">settings.BOUNDARY_METRICS</span></code></a> modified to include http_alerter type</li>
<li><a class="reference internal" href="../skyline.html#settings.BOUNDARY_ALERTER_OPTS" title="settings.BOUNDARY_ALERTER_OPTS"><code class="xref py py-mod docutils literal"><span class="pre">settings.BOUNDARY_ALERTER_OPTS</span></code></a> modified to include http_alerter type example</li>
<li><code class="xref py py-mod docutils literal"><span class="pre">settings.VISTA_FETCH_GRAPHITE_METRICS</span></code> was changed to
and <a class="reference internal" href="../skyline.html#settings.VISTA_FETCH_METRICS" title="settings.VISTA_FETCH_METRICS"><code class="xref py py-mod docutils literal"><span class="pre">settings.VISTA_FETCH_METRICS</span></code></a> the example Prometheus metric using a
custom URI was corrected to not pass a pre-population tuple</li>
</ul>
<p>New settings:</p>
<ul class="simple">
<li><a class="reference internal" href="../skyline.html#settings.VERIFY_SSL" title="settings.VERIFY_SSL"><code class="xref py py-mod docutils literal"><span class="pre">settings.VERIFY_SSL</span></code></a></li>
<li><a class="reference internal" href="../skyline.html#settings.SKYLINE_METRICS_CARBON_HOST" title="settings.SKYLINE_METRICS_CARBON_HOST"><code class="xref py py-mod docutils literal"><span class="pre">settings.SKYLINE_METRICS_CARBON_HOST</span></code></a></li>
<li><a class="reference internal" href="../skyline.html#settings.HTTP_ALERTERS_ENABLED" title="settings.HTTP_ALERTERS_ENABLED"><code class="xref py py-mod docutils literal"><span class="pre">settings.HTTP_ALERTERS_ENABLED</span></code></a></li>
<li><a class="reference internal" href="../skyline.html#settings.IDENTIFY_AIRGAPS" title="settings.IDENTIFY_AIRGAPS"><code class="xref py py-mod docutils literal"><span class="pre">settings.IDENTIFY_AIRGAPS</span></code></a></li>
<li><a class="reference internal" href="../skyline.html#settings.MAX_AIRGAP_PERIOD" title="settings.MAX_AIRGAP_PERIOD"><code class="xref py py-mod docutils literal"><span class="pre">settings.MAX_AIRGAP_PERIOD</span></code></a></li>
<li><a class="reference internal" href="../skyline.html#settings.HTTP_ALERTERS_OPTS" title="settings.HTTP_ALERTERS_OPTS"><code class="xref py py-mod docutils literal"><span class="pre">settings.HTTP_ALERTERS_OPTS</span></code></a></li>
<li><a class="reference internal" href="../skyline.html#settings.FLUX_MAX_AGE" title="settings.FLUX_MAX_AGE"><code class="xref py py-mod docutils literal"><span class="pre">settings.FLUX_MAX_AGE</span></code></a></li>
<li><a class="reference internal" href="../skyline.html#settings.VISTA_FETCH_METRICS" title="settings.VISTA_FETCH_METRICS"><code class="xref py py-mod docutils literal"><span class="pre">settings.VISTA_FETCH_METRICS</span></code></a></li>
<li><a class="reference internal" href="../skyline.html#settings.VISTA_GRAPHITE_BATCH_SIZE" title="settings.VISTA_GRAPHITE_BATCH_SIZE"><code class="xref py py-mod docutils literal"><span class="pre">settings.VISTA_GRAPHITE_BATCH_SIZE</span></code></a></li>
</ul>
</div>
</div>
<div class="section" id="how-to-update-from-v1-3-0-and-v1-3-1">
<h2>How to update from v1.3.0 (and v1.3.1)<a class="headerlink" href="#how-to-update-from-v1-3-0-and-v1-3-1" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Download the new release tag or clone/update to get it to a temp location,
ready to be deployed.</li>
</ul>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">NEW_SKYLINE_VERSION</span><span class="o">=</span><span class="s2">&quot;v2.0.0&quot;</span>    <span class="c1"># Your new Skyline version</span>
<span class="nv">OLD_SKYLINE_VERSION</span><span class="o">=</span><span class="s2">&quot;v1.3.0&quot;</span>    <span class="c1"># Your old Skyline version</span>
<span class="c1"># OR v1.3.1 if you updated to that version</span>
<span class="c1"># OLD_SKYLINE_VERSION=&quot;v1.3.0&quot;    # Your old Skyline version</span>

<span class="nv">CURRENT_SKYLINE_PATH</span><span class="o">=</span><span class="s2">&quot;/opt/skyline/github/skyline&quot;</span>                 <span class="c1"># Your Skyline path</span>
<span class="nv">NEW_SKYLINE_PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CURRENT_SKYLINE_PATH</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">NEW_SKYLINE_VERSION</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># Your new Skyline path</span>

mkdir -p <span class="s2">&quot;</span><span class="si">${</span><span class="nv">CURRENT_SKYLINE_PATH</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">NEW_SKYLINE_VERSION</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nb">cd</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">CURRENT_SKYLINE_PATH</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">NEW_SKYLINE_VERSION</span><span class="si">}</span><span class="s2">&quot;</span>
git clone https://github.com/earthgecko/skyline .
git checkout <span class="s2">&quot;</span><span class="nv">$NEW_SKYLINE_VERSION</span><span class="s2">&quot;</span>

cp <span class="s2">&quot;</span><span class="nv">$NEW_SKYLINE_PATH</span><span class="s2">/skyline/settings.py&quot;</span> <span class="s2">&quot;</span><span class="nv">$NEW_SKYLINE_PATH</span><span class="s2">/skyline/settings.py.</span><span class="si">${</span><span class="nv">NEW_SKYLINE_VERSION</span><span class="si">}</span><span class="s2">.bak&quot;</span>

<span class="c1"># DIFF your settings.py with the new settings.py</span>
diff <span class="s2">&quot;</span><span class="si">${</span><span class="nv">CURRENT_SKYLINE_PATH</span><span class="si">}</span><span class="s2">/skyline/settings.py&quot;</span> <span class="s2">&quot;</span><span class="nv">$NEW_SKYLINE_PATH</span><span class="s2">/skyline/settings.py.</span><span class="si">${</span><span class="nv">NEW_SKYLINE_VERSION</span><span class="si">}</span><span class="s2">.bak&quot;</span>

<span class="c1"># Create a new settings.py file in the new version based on your existing</span>
<span class="c1"># settings.py file</span>
cat <span class="s2">&quot;</span><span class="si">${</span><span class="nv">CURRENT_SKYLINE_PATH</span><span class="si">}</span><span class="s2">/skyline/settings.py&quot;</span> &gt; <span class="s2">&quot;</span><span class="nv">$NEW_SKYLINE_PATH</span><span class="s2">/skyline/settings.py&quot;</span>

<span class="c1"># ADD the appropriate new settings to your settings file and modify any</span>
<span class="c1"># changed settings as appropriate for your set up.</span>
vi <span class="s2">&quot;</span><span class="nv">$NEW_SKYLINE_PATH</span><span class="s2">/skyline/settings.py&quot;</span>

<span class="c1"># Stop Skyline DB related services</span>
<span class="nv">SKYLINE_SERVICES</span><span class="o">=</span><span class="s2">&quot;webapp</span>
<span class="s2">ionosphere</span>
<span class="s2">luminosity</span>
<span class="s2">panorama&quot;</span>
<span class="k">for</span> i in <span class="nv">$SKYLINE_SERVICES</span>
<span class="k">do</span>
  /etc/init.d/<span class="nv">$i</span> stop
  <span class="c1"># or</span>
  <span class="c1"># systemctl stop $i</span>
<span class="k">done</span>
<span class="c1"># And stop any service controls like monit or systemd</span>

<span class="c1"># BACKUP THE DB AND APPLY THE NEW SQL</span>
<span class="nv">BACKUP_DIR</span><span class="o">=</span><span class="s2">&quot;/tmp&quot;</span>  <span class="c1"># Where you want to backup the DB to</span>
<span class="nv">MYSQL_USER</span><span class="o">=</span><span class="s2">&quot;&lt;YOUR_MYSQL_USER&gt;&quot;</span>
<span class="nv">MYSQL_HOST</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span>  <span class="c1"># Your MySQL IP</span>
<span class="nv">MYSQL_DB</span><span class="o">=</span><span class="s2">&quot;skyline&quot;</span>  <span class="c1"># Your MySQL Skyline DB name</span>

<span class="c1"># Backup DB</span>
mkdir -p <span class="nv">$BACKUP_DIR</span>
mysqldump -u<span class="nv">$MYSQL_USER</span> -p <span class="nv">$MYSQL_DB</span> &gt; <span class="nv">$BACKUP_DIR</span>/pre.<span class="nv">$NEW_SKYLINE_VERSION</span>.<span class="nv">$MYSQL_DB</span>.sql

<span class="c1"># Update DB</span>
mysql -u<span class="nv">$MYSQL_USER</span> -p <span class="nv">$MYSQL_DB</span> &lt; <span class="s2">&quot;</span><span class="si">${</span><span class="nv">NEW_SKYLINE_PATH</span><span class="si">}</span><span class="s2">/updates/sql/</span><span class="si">${</span><span class="nv">NEW_SKYLINE_VERSION</span><span class="si">}</span><span class="s2">.sql&quot;</span>

<span class="c1"># Stop all other Skyline services</span>
<span class="nv">SKYLINE_SERVICES</span><span class="o">=</span><span class="s2">&quot;horizon</span>
<span class="s2">analyzer</span>
<span class="s2">mirage</span>
<span class="s2">crucible</span>
<span class="s2">boundary</span>
<span class="s2">ionosphere</span>
<span class="s2">luminosity</span>
<span class="s2">panorama</span>
<span class="s2">webapp</span>
<span class="s2">vista</span>
<span class="s2">flux&quot;</span>
<span class="k">for</span> i in <span class="nv">$SKYLINE_SERVICES</span>
<span class="k">do</span>
  /etc/init.d/<span class="nv">$i</span> stop
  <span class="c1"># or</span>
  <span class="c1"># systemctl stop $i</span>
<span class="k">done</span>
</pre></div>
</div>
<ul class="simple">
<li>Move your current Skyline directory to a backup directory and move the new
Skyline v2.0.0 with your new settings.py from the temp location to your
working Skyline directory, (change your paths as appropriate) e.g.</li>
</ul>
<div class="highlight-bash"><div class="highlight"><pre><span></span>mv <span class="s2">&quot;</span><span class="nv">$CURRENT_SKYLINE_PATH</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">CURRENT_SKYLINE_PATH</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">OLD_SKYLINE_VERSION</span><span class="si">}</span><span class="s2">&quot;</span>
mv <span class="s2">&quot;</span><span class="nv">$NEW_SKYLINE_PATH</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$CURRENT_SKYLINE_PATH</span><span class="s2">&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li>Update the dependencies</li>
</ul>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">PYTHON_MAJOR_VERSION</span><span class="o">=</span><span class="s2">&quot;2.7&quot;</span>
<span class="nv">PYTHON_VIRTUALENV_DIR</span><span class="o">=</span><span class="s2">&quot;/opt/python_virtualenv&quot;</span>
<span class="c1"># Handle 2.7.14 and 2.7.16</span>
<span class="nv">PROJECT</span><span class="o">=</span><span class="s2">&quot;skyline-py2716&quot;</span>
<span class="k">if</span> <span class="o">[</span> ! -d <span class="s2">&quot;</span><span class="si">${</span><span class="nv">PYTHON_VIRTUALENV_DIR</span><span class="si">}</span><span class="s2">/projects/</span><span class="si">${</span><span class="nv">PROJECT</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nv">PROJECT</span><span class="o">=</span><span class="s2">&quot;skyline-py2714&quot;</span>
<span class="k">fi</span>
<span class="nb">cd</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">PYTHON_VIRTUALENV_DIR</span><span class="si">}</span><span class="s2">/projects/</span><span class="si">${</span><span class="nv">PROJECT</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nb">source</span> bin/activate
<span class="c1"># This can take lots of minutes with the new pandas</span>
bin/<span class="s2">&quot;pip</span><span class="si">${</span><span class="nv">PYTHON_MAJOR_VERSION</span><span class="si">}</span><span class="s2">&quot;</span> install <span class="k">$(</span>cat <span class="s2">&quot;</span><span class="si">${</span><span class="nv">CURRENT_SKYLINE_PATH</span><span class="si">}</span><span class="s2">/requirements.txt&quot;</span> <span class="p">|</span> grep <span class="s2">&quot;^numpy\|^scipy\|^patsy\|^pandas&quot;</span> <span class="p">|</span> tr <span class="s1">&#39;\n&#39;</span> <span class="s1">&#39; &#39;</span><span class="k">)</span>
<span class="c1"># Remove the luminol egg as it will already be installed and pip will moan</span>
cat <span class="s2">&quot;</span><span class="si">${</span><span class="nv">CURRENT_SKYLINE_PATH</span><span class="si">}</span><span class="s2">/requirements.txt&quot;</span> <span class="p">|</span> grep -v <span class="s2">&quot;luminol&quot;</span> &gt; /tmp/requirements.txt

<span class="c1"># IF YOU ARE ON CENTOS 6 and running mainstream mysql-server-5.1 uncomment</span>
<span class="c1"># the following line and run it to fix to mysql-python-connector 8.0.6</span>
<span class="c1">#cat &quot;${CURRENT_SKYLINE_PATH}/requirements.txt&quot; | grep -v &quot;luminol\|mysql-connector-python&quot; &gt; /tmp/requirements.txt</span>

bin/<span class="s2">&quot;pip</span><span class="si">${</span><span class="nv">PYTHON_MAJOR_VERSION</span><span class="si">}</span><span class="s2">&quot;</span> install -r /tmp/requirements.txt
</pre></div>
</div>
<ul class="simple">
<li>Start the all Skyline services (change as appropriate for your set up) e.g.</li>
</ul>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># Start all other Skyline services</span>
<span class="nv">SKYLINE_SERVICES</span><span class="o">=</span><span class="s2">&quot;panorama</span>
<span class="s2">horizon</span>
<span class="s2">flux</span>
<span class="s2">vista</span>
<span class="s2">luminosity</span>
<span class="s2">analyzer</span>
<span class="s2">mirage</span>
<span class="s2">crucible</span>
<span class="s2">boundary</span>
<span class="s2">ionosphere</span>
<span class="s2">webapp&quot;</span>
<span class="k">for</span> i in <span class="nv">$SKYLINE_SERVICES</span>
<span class="k">do</span>
  /etc/init.d/<span class="nv">$i</span> start
  <span class="c1"># or</span>
  <span class="c1"># systemctl start $i</span>
<span class="k">done</span>
</pre></div>
</div>
<ul class="simple">
<li>Check the logs</li>
</ul>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># How are they running</span>
tail -n <span class="m">20</span> /var/log/skyline/*.log

<span class="c1"># Any errors - each app</span>
find /var/log/skyline -type f -name <span class="s2">&quot;*.log&quot;</span> <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> skyline_logfile
<span class="k">do</span>
  <span class="nb">echo</span> <span class="s2">&quot;#####</span>
<span class="s2"># Checking for errors in </span><span class="nv">$skyline_logfile</span><span class="s2">&quot;</span>
  cat <span class="s2">&quot;</span><span class="nv">$skyline_logfile</span><span class="s2">&quot;</span> <span class="p">|</span> grep -B2 -A10 -i <span class="s2">&quot;error ::\|traceback&quot;</span> <span class="p">|</span> tail -n <span class="m">60</span>
  <span class="nb">echo</span> <span class="s2">&quot;&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;&quot;</span>
<span class="k">done</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2014, Etsy Inc; 2015, Abe Stanway; 2015-2020, Gary Wilson.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>